(function(d,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],u):(d=typeof globalThis<"u"?globalThis:d||self,u(d.NexusRenderCore={},d.React))})(this,function(d,u){"use strict";const re=new Map;function dt(e,t,n="1.0.0"){const r=re.get(e)||{};r[n]=t,re.set(e,r)}function ye(e,t="1.0.0"){return(re.get(e)||{})[t]||null}function pt(e={}){return{...e}}var he={exports:{}},K={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gt=u,yt=Symbol.for("react.element"),ht=Symbol.for("react.fragment"),_t=Object.prototype.hasOwnProperty,vt=gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bt={key:!0,ref:!0,__self:!0,__source:!0};function _e(e,t,n){var r,a={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)_t.call(t,r)&&!bt.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:yt,type:e,key:o,ref:i,props:a,_owner:vt.current}}K.Fragment=ht,K.jsx=_e,K.jsxs=_e,he.exports=K;var $=he.exports;const ve=u.createContext(null),be=u.createContext({});var me=typeof global=="object"&&global&&global.Object===Object&&global,mt=typeof self=="object"&&self&&self.Object===Object&&self,w=me||mt||Function("return this")(),M=w.Symbol,Se=Object.prototype,St=Se.hasOwnProperty,wt=Se.toString,J=M?M.toStringTag:void 0;function Tt(e){var t=St.call(e,J),n=e[J];try{e[J]=void 0;var r=!0}catch{}var a=wt.call(e);return r&&(t?e[J]=n:delete e[J]),a}var At=Object.prototype,Et=At.toString;function Ot(e){return Et.call(e)}var jt="[object Null]",Rt="[object Undefined]",we=M?M.toStringTag:void 0;function H(e){return e==null?e===void 0?Rt:jt:we&&we in Object(e)?Tt(e):Ot(e)}function U(e){return e!=null&&typeof e=="object"}var X=Array.isArray;function Te(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Pt="[object AsyncFunction]",xt="[object Function]",Ct="[object GeneratorFunction]",It="[object Proxy]";function Ae(e){if(!Te(e))return!1;var t=H(e);return t==xt||t==Ct||t==Pt||t==It}var oe=w["__core-js_shared__"],Ee=function(){var e=/[^.]+$/.exec(oe&&oe.keys&&oe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Mt(e){return!!Ee&&Ee in e}var Nt=Function.prototype,Lt=Nt.toString;function R(e){if(e!=null){try{return Lt.call(e)}catch{}try{return e+""}catch{}}return""}var Ft=/[\\^$.*+?()[\]{}|]/g,Dt=/^\[object .+?Constructor\]$/,$t=Function.prototype,Jt=Object.prototype,Ht=$t.toString,Ut=Jt.hasOwnProperty,Gt=RegExp("^"+Ht.call(Ut).replace(Ft,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zt(e){if(!Te(e)||Mt(e))return!1;var t=Ae(e)?Gt:Dt;return t.test(R(e))}function Bt(e,t){return e==null?void 0:e[t]}function N(e,t){var n=Bt(e,t);return zt(n)?n:void 0}var ae=N(w,"WeakMap"),Wt=9007199254740991,Kt=/^(?:0|[1-9]\d*)$/;function Xt(e,t){var n=typeof e;return t=t??Wt,!!t&&(n=="number"||n!="symbol"&&Kt.test(e))&&e>-1&&e%1==0&&e<t}function Oe(e,t){return e===t||e!==e&&t!==t}var Yt=9007199254740991;function je(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Yt}function Zt(e){return e!=null&&je(e.length)&&!Ae(e)}var Qt=Object.prototype;function qt(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Qt;return e===n}function Vt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var kt="[object Arguments]";function Re(e){return U(e)&&H(e)==kt}var Pe=Object.prototype,en=Pe.hasOwnProperty,tn=Pe.propertyIsEnumerable,nn=Re(function(){return arguments}())?Re:function(e){return U(e)&&en.call(e,"callee")&&!tn.call(e,"callee")};function rn(){return!1}var xe=typeof d=="object"&&d&&!d.nodeType&&d,Ce=xe&&typeof module=="object"&&module&&!module.nodeType&&module,on=Ce&&Ce.exports===xe,Ie=on?w.Buffer:void 0,an=Ie?Ie.isBuffer:void 0,ie=an||rn,sn="[object Arguments]",cn="[object Array]",un="[object Boolean]",fn="[object Date]",ln="[object Error]",dn="[object Function]",pn="[object Map]",gn="[object Number]",yn="[object Object]",hn="[object RegExp]",_n="[object Set]",vn="[object String]",bn="[object WeakMap]",mn="[object ArrayBuffer]",Sn="[object DataView]",wn="[object Float32Array]",Tn="[object Float64Array]",An="[object Int8Array]",En="[object Int16Array]",On="[object Int32Array]",jn="[object Uint8Array]",Rn="[object Uint8ClampedArray]",Pn="[object Uint16Array]",xn="[object Uint32Array]",l={};l[wn]=l[Tn]=l[An]=l[En]=l[On]=l[jn]=l[Rn]=l[Pn]=l[xn]=!0,l[sn]=l[cn]=l[mn]=l[un]=l[Sn]=l[fn]=l[ln]=l[dn]=l[pn]=l[gn]=l[yn]=l[hn]=l[_n]=l[vn]=l[bn]=!1;function Cn(e){return U(e)&&je(e.length)&&!!l[H(e)]}function In(e){return function(t){return e(t)}}var Me=typeof d=="object"&&d&&!d.nodeType&&d,G=Me&&typeof module=="object"&&module&&!module.nodeType&&module,Mn=G&&G.exports===Me,se=Mn&&me.process,Ne=function(){try{var e=G&&G.require&&G.require("util").types;return e||se&&se.binding&&se.binding("util")}catch{}}(),Le=Ne&&Ne.isTypedArray,Fe=Le?In(Le):Cn,Nn=Object.prototype,Ln=Nn.hasOwnProperty;function Fn(e,t){var n=X(e),r=!n&&nn(e),a=!n&&!r&&ie(e),o=!n&&!r&&!a&&Fe(e),i=n||r||a||o,s=i?Vt(e.length,String):[],c=s.length;for(var f in e)Ln.call(e,f)&&!(i&&(f=="length"||a&&(f=="offset"||f=="parent")||o&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Xt(f,c)))&&s.push(f);return s}function Dn(e,t){return function(n){return e(t(n))}}var $n=Dn(Object.keys,Object),Jn=Object.prototype,Hn=Jn.hasOwnProperty;function Un(e){if(!qt(e))return $n(e);var t=[];for(var n in Object(e))Hn.call(e,n)&&n!="constructor"&&t.push(n);return t}function Gn(e){return Zt(e)?Fn(e):Un(e)}var z=N(Object,"create");function zn(){this.__data__=z?z(null):{},this.size=0}function Bn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Wn="__lodash_hash_undefined__",Kn=Object.prototype,Xn=Kn.hasOwnProperty;function Yn(e){var t=this.__data__;if(z){var n=t[e];return n===Wn?void 0:n}return Xn.call(t,e)?t[e]:void 0}var Zn=Object.prototype,Qn=Zn.hasOwnProperty;function qn(e){var t=this.__data__;return z?t[e]!==void 0:Qn.call(t,e)}var Vn="__lodash_hash_undefined__";function kn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=z&&t===void 0?Vn:t,this}function P(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}P.prototype.clear=zn,P.prototype.delete=Bn,P.prototype.get=Yn,P.prototype.has=qn,P.prototype.set=kn;function er(){this.__data__=[],this.size=0}function Y(e,t){for(var n=e.length;n--;)if(Oe(e[n][0],t))return n;return-1}var tr=Array.prototype,nr=tr.splice;function rr(e){var t=this.__data__,n=Y(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():nr.call(t,n,1),--this.size,!0}function or(e){var t=this.__data__,n=Y(t,e);return n<0?void 0:t[n][1]}function ar(e){return Y(this.__data__,e)>-1}function ir(e,t){var n=this.__data__,r=Y(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function T(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}T.prototype.clear=er,T.prototype.delete=rr,T.prototype.get=or,T.prototype.has=ar,T.prototype.set=ir;var B=N(w,"Map");function sr(){this.size=0,this.__data__={hash:new P,map:new(B||T),string:new P}}function cr(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Z(e,t){var n=e.__data__;return cr(t)?n[typeof t=="string"?"string":"hash"]:n.map}function ur(e){var t=Z(this,e).delete(e);return this.size-=t?1:0,t}function fr(e){return Z(this,e).get(e)}function lr(e){return Z(this,e).has(e)}function dr(e,t){var n=Z(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function x(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}x.prototype.clear=sr,x.prototype.delete=ur,x.prototype.get=fr,x.prototype.has=lr,x.prototype.set=dr;function pr(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}function gr(){this.__data__=new T,this.size=0}function yr(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function hr(e){return this.__data__.get(e)}function _r(e){return this.__data__.has(e)}var vr=200;function br(e,t){var n=this.__data__;if(n instanceof T){var r=n.__data__;if(!B||r.length<vr-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new x(r)}return n.set(e,t),this.size=n.size,this}function E(e){var t=this.__data__=new T(e);this.size=t.size}E.prototype.clear=gr,E.prototype.delete=yr,E.prototype.get=hr,E.prototype.has=_r,E.prototype.set=br;function mr(e,t){for(var n=-1,r=e==null?0:e.length,a=0,o=[];++n<r;){var i=e[n];t(i,n,e)&&(o[a++]=i)}return o}function Sr(){return[]}var wr=Object.prototype,Tr=wr.propertyIsEnumerable,De=Object.getOwnPropertySymbols,Ar=De?function(e){return e==null?[]:(e=Object(e),mr(De(e),function(t){return Tr.call(e,t)}))}:Sr;function Er(e,t,n){var r=t(e);return X(e)?r:pr(r,n(e))}function $e(e){return Er(e,Gn,Ar)}var ce=N(w,"DataView"),ue=N(w,"Promise"),fe=N(w,"Set"),Je="[object Map]",Or="[object Object]",He="[object Promise]",Ue="[object Set]",Ge="[object WeakMap]",ze="[object DataView]",jr=R(ce),Rr=R(B),Pr=R(ue),xr=R(fe),Cr=R(ae),O=H;(ce&&O(new ce(new ArrayBuffer(1)))!=ze||B&&O(new B)!=Je||ue&&O(ue.resolve())!=He||fe&&O(new fe)!=Ue||ae&&O(new ae)!=Ge)&&(O=function(e){var t=H(e),n=t==Or?e.constructor:void 0,r=n?R(n):"";if(r)switch(r){case jr:return ze;case Rr:return Je;case Pr:return He;case xr:return Ue;case Cr:return Ge}return t});var Be=w.Uint8Array,Ir="__lodash_hash_undefined__";function Mr(e){return this.__data__.set(e,Ir),this}function Nr(e){return this.__data__.has(e)}function Q(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new x;++t<n;)this.add(e[t])}Q.prototype.add=Q.prototype.push=Mr,Q.prototype.has=Nr;function Lr(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Fr(e,t){return e.has(t)}var Dr=1,$r=2;function We(e,t,n,r,a,o){var i=n&Dr,s=e.length,c=t.length;if(s!=c&&!(i&&c>s))return!1;var f=o.get(e),g=o.get(t);if(f&&g)return f==t&&g==e;var y=-1,p=!0,h=n&$r?new Q:void 0;for(o.set(e,t),o.set(t,e);++y<s;){var _=e[y],b=t[y];if(r)var v=i?r(b,_,y,t,e,o):r(_,b,y,e,t,o);if(v!==void 0){if(v)continue;p=!1;break}if(h){if(!Lr(t,function(m,A){if(!Fr(h,A)&&(_===m||a(_,m,n,r,o)))return h.push(A)})){p=!1;break}}else if(!(_===b||a(_,b,n,r,o))){p=!1;break}}return o.delete(e),o.delete(t),p}function Jr(e){var t=-1,n=Array(e.size);return e.forEach(function(r,a){n[++t]=[a,r]}),n}function Hr(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var Ur=1,Gr=2,zr="[object Boolean]",Br="[object Date]",Wr="[object Error]",Kr="[object Map]",Xr="[object Number]",Yr="[object RegExp]",Zr="[object Set]",Qr="[object String]",qr="[object Symbol]",Vr="[object ArrayBuffer]",kr="[object DataView]",Ke=M?M.prototype:void 0,le=Ke?Ke.valueOf:void 0;function eo(e,t,n,r,a,o,i){switch(n){case kr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Vr:return!(e.byteLength!=t.byteLength||!o(new Be(e),new Be(t)));case zr:case Br:case Xr:return Oe(+e,+t);case Wr:return e.name==t.name&&e.message==t.message;case Yr:case Qr:return e==t+"";case Kr:var s=Jr;case Zr:var c=r&Ur;if(s||(s=Hr),e.size!=t.size&&!c)return!1;var f=i.get(e);if(f)return f==t;r|=Gr,i.set(e,t);var g=We(s(e),s(t),r,a,o,i);return i.delete(e),g;case qr:if(le)return le.call(e)==le.call(t)}return!1}var to=1,no=Object.prototype,ro=no.hasOwnProperty;function oo(e,t,n,r,a,o){var i=n&to,s=$e(e),c=s.length,f=$e(t),g=f.length;if(c!=g&&!i)return!1;for(var y=c;y--;){var p=s[y];if(!(i?p in t:ro.call(t,p)))return!1}var h=o.get(e),_=o.get(t);if(h&&_)return h==t&&_==e;var b=!0;o.set(e,t),o.set(t,e);for(var v=i;++y<c;){p=s[y];var m=e[p],A=t[p];if(r)var S=i?r(A,m,p,t,e,o):r(m,A,p,e,t,o);if(!(S===void 0?m===A||a(m,A,n,r,o):S)){b=!1;break}v||(v=p=="constructor")}if(b&&!v){var F=e.constructor,D=t.constructor;F!=D&&"constructor"in e&&"constructor"in t&&!(typeof F=="function"&&F instanceof F&&typeof D=="function"&&D instanceof D)&&(b=!1)}return o.delete(e),o.delete(t),b}var ao=1,Xe="[object Arguments]",Ye="[object Array]",q="[object Object]",io=Object.prototype,Ze=io.hasOwnProperty;function so(e,t,n,r,a,o){var i=X(e),s=X(t),c=i?Ye:O(e),f=s?Ye:O(t);c=c==Xe?q:c,f=f==Xe?q:f;var g=c==q,y=f==q,p=c==f;if(p&&ie(e)){if(!ie(t))return!1;i=!0,g=!1}if(p&&!g)return o||(o=new E),i||Fe(e)?We(e,t,n,r,a,o):eo(e,t,c,n,r,a,o);if(!(n&ao)){var h=g&&Ze.call(e,"__wrapped__"),_=y&&Ze.call(t,"__wrapped__");if(h||_){var b=h?e.value():e,v=_?t.value():t;return o||(o=new E),a(b,v,n,r,o)}}return p?(o||(o=new E),oo(e,t,n,r,a,o)):!1}function Qe(e,t,n,r,a){return e===t?!0:e==null||t==null||!U(e)&&!U(t)?e!==e&&t!==t:so(e,t,n,r,Qe,a)}function co(e,t){return Qe(e,t)}const qe=e=>u.createElement("div",e),Ve=e=>u.createElement(qe,{style:{width:"100%",height:"50px",lineHeight:"50px",textAlign:"center",fontSize:"15px",color:"#ff0000",border:"2px solid #ff0000"}},`${e.__schema.componentName||""} 组件渲染异常，请查看控制台日志`),ke=e=>{var t;return u.useEffect(()=>{console.warn(`Component ${e.__schema.componentName} not registered`)},[(t=e==null?void 0:e.__schema)==null?void 0:t.componentName]),e.enableStrictNotFoundMode?$.jsx($.Fragment,{children:`${e.__schema.componentName||""} Component Not Found`}):u.createElement(qe,e,e.children||`${e.__schema.componentName||""} Component Not Found`)};function et(){try{return window.parent!==window&&window.parent.location.host===window.location.host}catch{return!1}}function C(e,t,n=!1){let r,a,o,i;typeof e=="object"&&t===void 0?(r=e.str,a=e.self,o=e.thisRequired,i=e.logScope):(r=e,a=t,o=n);try{const s=['"use strict";',"var __self = arguments[0];"];s.push("return ");let c;if(c=(r.value||"").trim(),c=c.replace(/this(\W|$)/g,(g,y)=>`__self${y}`),c=s.join(`
`)+c,et()&&window.parent.__newFunc)return window.parent.__newFunc(c)(a);const f=`with(${o?"{}":"$scope || {}"}) { ${c} }`;return new Function("$scope",f)(a)}catch(s){console.error(`${i||""} parseExpression.error`,s,r,(a==null?void 0:a.__self)??a);return}}function uo(e){return typeof e!="string"?e:et()&&window.parent.__newFunc?window.parent.__newFunc(`"use strict"; return ${e}`)():new Function(`"use strict"; return ${e}`)()}function fo(e,t){return C(e,t,!0)}const lo={JSEXPRESSION:"JSExpression"};function tt(e,t){return C({type:lo.JSEXPRESSION,value:`this.i18n('${e.key}')`},t)}function V(e){return e!==null&&typeof e=="object"}function po(e){return{}.toString.call(e)==="[object String]"}const go=e=>Object.prototype.toString.call(e),nt=(e,t)=>go(e)===`[object ${t}]`,rt=e=>e===null,yo=e=>nt(e,"String"),ho=e=>!rt(e)&&nt(e,"Object"),_o=e=>Array.isArray(e),vo=e=>e instanceof Map,bo=e=>e instanceof Set,ot=e=>rt(e)?!0:_o(e)||yo(e)?e.length===0:vo(e)||bo(e)?e.size===0:ho(e)?Object.keys(e).length===0:!0;function L(e){return V(e)?e.type==="JSExpression"&&e.extType!=="function":!1}function mo(e){return V(e)?e.type==="i18n":!1}function at(e,t,n){!e||Array.isArray(e)||po(e)||typeof e!="object"||Object.keys(e).forEach(r=>t.call(n,e[r],r))}function k(e){return V(e)?e.type==="JSFunction"||So(e):!1}function So(e){return V(e)?e.type==="JSExpression"&&e.extType==="function":!1}function it(e){if(ot(e))return!1;if(e.componentName==="Leaf"||e.componentName==="Slot")return!0;if(Array.isArray(e))return e.every(n=>it(n));const t=n=>n?L(n)?!0:typeof e.props=="object"&&!Array.isArray(n):!1;return!!(e.componentName&&t(e.props))}function ee(e,t,n={}){if(L(e))try{return C({str:e,self:t,thisRequired:n.thisRequiredInJSE,logScope:n.logScope})}catch(r){console.log(r)}else{if(mo(e))return tt(e,t);if(typeof e=="string")return e.trim();if(Array.isArray(e))return e.map(r=>ee(r,t,n));if(typeof e=="function")return e.bind(t);if(typeof e=="object"){if(!e)return e;const r={};return at(e,(a,o)=>{o.startsWith("__")||(r[o]=ee(a,t,n))}),r}}return e}const wo=e=>{const{renderContext:t}=u.useContext(be),n=u.useCallback(r=>{const a={};return Object.entries(r).forEach(([o,i])=>{if(L(i))try{a[o]=C(i,t,!0)??i.mock}catch(s){console.warn(`JSExpression 解析失败 (${o}):`,s),a[o]=i.mock}else if(k(i))try{const s=uo(i.value);a[o]=(...c)=>{var f;return(f=s==null?void 0:s.call)==null?void 0:f.call(s,t,...c)}}catch(s){console.warn(`JSFunction 解析失败 (${o}):`,s),a[o]=()=>{}}else Array.isArray(i)?a[o]=i.map(s=>n(s)):typeof i=="object"&&i!==null?a[o]=n(i):a[o]=i}),a},[t]);return u.useMemo(()=>n(e),[e,t.state,t])},st="$$LCNodeId",To=["$$typeof","render","defaultProps","props","length","prototype","name","caller","callee","arguments"];function Ao(e,t,n=To){return Object.keys(t).filter(a=>!n.includes(a)).forEach(a=>{e[a]=t[a]}),e}const te=new Map;function Eo(e,t){var a,o,i,s;if((a=e==null?void 0:e.prototype)!=null&&a.isReactComponent||(o=e==null?void 0:e.prototype)!=null&&o.setState||(e==null?void 0:e.prototype)instanceof u.Component)return e;if(te.has(t.schema.id)&&((i=te.get(t.schema.id))==null?void 0:i.Comp)===e)return(s=te.get(t.schema.id))==null?void 0:s.WrapperComponent;class n extends u.Component{render(){return u.createElement(e,{...this.props,ref:this.props.forwardRef})}}n.displayName=e.displayName;const r=Ao(u.forwardRef((c,f)=>u.createElement(n,{...c,forwardRef:f})),e);return te.set(t.schema.id,{WrapperComponent:r,Comp:e}),r}const ct=u.memo(e=>{const{schema:t}=e,{onCompGetCtx:n,onCompGetRef:r,customCreateElement:a=u.createElement,getFaultComponent:o,getNotFoundComponent:i}=u.useContext(ve);let s=t.componentName;s==="Page"&&(s="LowcodePage");let c=ye(s,t.version);c||(c=(i==null?void 0:i())||ke);const f=wo(t.props||{});try{const g=Symbol.for(t.id),p=(()=>{let h=null;Array.isArray(t.children)?h=(t.children||[]).map((v,m)=>u.createElement(ct,{schema:v,key:v.id||`${v.id}_${m}`},t.children==="string"?t.children:null)):typeof t.children=="string"&&(h=t.children);const _=Eo(c,{schema:t}),b={...f,__id:t.id,__schema:t,[st]:g,ref:v=>{r==null||r(t,v,g)}};return a(_,b,h)})();return n==null||n(t,p,g),p}catch{return a((o==null?void 0:o())||Ve,{...f,__schema:t},null)}},(e,t)=>co(e.schema,t.schema)),Oo=(e,t)=>!Object.is(e,t);function jo(e,t=Oo){const n=u.useRef(),r=u.useRef();return t(r.current,e)&&(n.current=r.current,r.current=e),n.current}const Ro=e=>{const{schema:t,appHelper:n}=e,r=u.useRef(null),a=u.useRef(!1),o=u.useRef([]),[i,s]=u.useState({}),c=u.useRef({}),[f,g]=u.useState({}),y=u.useRef({}),p=jo(t),[h,_]=u.useState(0);return{renderContext:u.useMemo(()=>{const{utils:v={},constants:m={},...A}=n;let S={...r.current,...y.current,utils:v,constants:m,...A,setState:(W={})=>{const j={...c.current,...W};c.current=j,console.log(j),s(j),_(h+1)}};const F=()=>{const W=ee((t==null?void 0:t.state)||{},void 0);return Object.assign(W,c.current||{})},D=(W={})=>{const j=t||{},ge={...W||{}},ft=Object.keys((j==null?void 0:j.methods)||{})||[];return(o.current||[]).forEach(ne=>{ft.includes(ne)||delete ge[ne]}),o.current=ft,at(j.methods,(ne,lt)=>{let I=ne;if((L(I)||k(I))&&(I=C({str:I,self:S,thisRequired:e==null?void 0:e.thisRequiredInJSE,logScope:t.componentName})),typeof I!="function"){console.error(`custom method ${lt} can not be parsed to a valid function`,I);return}ge[lt]=I.bind(S)}),ge},de=F()||{};S.state=de,s(de),c.current=de;const pe=D();return S=Object.assign(S,{...y.current||{},...pe}),g(pe),y.current=pe,r.current=S,a.current=!0,S},[n,e==null?void 0:e.thisRequiredInJSE,t,h]),contextRef:r.current,isReady:a.current,previousSchema:p,rootState:i,rootMethods:f}};function Po(e,t,n={}){if(Array.isArray(e)||ot(e)||typeof e!="object")return n;const r=t.split(".").reduce((a,o)=>a&&a[o],e);return r===void 0?n:r}function xo(e,t,n,r,a){if(!e||!it(t)||!n)return;let i=Po(t,"lifeCycles",{})[n];if(i){if((L(i)||k(i))&&(i=a?fo(i,e):C(i,e)),typeof i!="function"){console.error(`生命周期${n}类型不符`,i);return}try{return i.apply(e,r)}catch(s){console.error(`[${t.componentName}]生命周期${n}出错`,s)}}}const ut=(e,t)=>{const{context:n,schema:r,thisRequiredInJSE:a,method:o}=e;xo(n,r,o,t,a)},Co=e=>{const{context:t,schema:n,thisRequiredInJSE:r,isReady:a}=e,o=u.useRef(!1);u.useEffect(()=>{a&&!o.current&&n&&(console.log("componentDidMount"),ut({context:t,schema:n,thisRequiredInJSE:r,method:"componentDidMount"}),o.current=!0)},[t,a,n,r]),u.useEffect(()=>()=>{a&&n&&ut({context:t,schema:n,thisRequiredInJSE:r,method:"componentWillUnmount"})},[t,a,n,r])},Io=u.forwardRef((e,t)=>{const{designMode:n="live",schema:r,appHelper:a,onCompGetRef:o,onCompGetCtx:i,notFoundComponent:s,faultComponent:c}=e,{isReady:f,renderContext:g,rootState:y,rootMethods:p}=Ro({schema:r,thisRequiredInJSE:e.thisRequiredInJSE,appHelper:a});return Co({context:g,isReady:f,schema:r,thisRequiredInJSE:e.thisRequiredInJSE}),u.useImperativeHandle(t,()=>({getRenderContext:()=>g,renderContext:g})),$.jsx(ve.Provider,{value:{onCompGetRef:o,onCompGetCtx:i,designMode:n,customCreateElement:e.customCreateElement,getNotFoundComponent:()=>s||ke,getFaultComponent:()=>c||Ve},children:$.jsx(be.Provider,{value:{renderContext:g,rootState:y,rootMethods:p},children:r&&$.jsx(ct,{schema:r})})})});d.LCNodeId=st,d.NexusRenderer=Io,d.createAppHelper=pt,d.getComponent=ye,d.isJSExpression=L,d.isJSFunction=k,d.parseData=ee,d.parseExpression=C,d.parseI18n=tt,d.registerComponent=dt,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
